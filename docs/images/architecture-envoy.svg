<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   width="1200"
   height="600"
   version="1.1"
   id="svg62"
   sodipodi:docname="architecture-envoy.svg"
   inkscape:version="1.4.2 (ebf0e940, 2025-05-08)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview62"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:zoom="1.3866667"
     inkscape:cx="620.55287"
     inkscape:cy="354.08653"
     inkscape:window-width="2560"
     inkscape:window-height="1387"
     inkscape:window-x="0"
     inkscape:window-y="25"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg62" />
  <defs
     id="defs11">
    <!-- Gradients -->
    <linearGradient
       id="f5xcGradient"
       x1="0%"
       y1="0%"
       x2="100%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#0066cc;stop-opacity:1"
         id="stop1" />
      <stop
         offset="100%"
         style="stop-color:#004499;stop-opacity:1"
         id="stop2" />
    </linearGradient>
    <linearGradient
       id="k8sGradient"
       x1="22.962172"
       y1="467.33384"
       x2="539.37673"
       y2="983.7484"
       gradientTransform="matrix(2.1336002,0,0,0.5555714,0.09681351,-34.734131)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#326ce5;stop-opacity:1"
         id="stop3" />
      <stop
         offset="100%"
         style="stop-color:#1e4db8;stop-opacity:1"
         id="stop4" />
    </linearGradient>
    <linearGradient
       id="proxyGradient"
       x1="199.65703"
       y1="776.35759"
       x2="285.80226"
       y2="862.50281"
       gradientTransform="matrix(2.1011031,0,0,0.47594048,82.961394,6)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#ff6b35;stop-opacity:1"
         id="stop5" />
      <stop
         offset="100%"
         style="stop-color:#e55a2b;stop-opacity:1"
         id="stop6" />
    </linearGradient>
    <linearGradient
       id="tailscaleGradient"
       x1="0%"
       y1="0%"
       x2="100%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#ff6b35;stop-opacity:1"
         id="stop7" />
      <stop
         offset="100%"
         style="stop-color:#e55a2b;stop-opacity:1"
         id="stop8" />
    </linearGradient>
    <linearGradient
       id="serviceGradient"
       x1="13.366331"
       y1="1646.0014"
       x2="313.97239"
       y2="1946.6075"
       gradientTransform="matrix(3.6656377,0,0,0.29707509,0.13624179,69.228034)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#28a745;stop-opacity:1"
         id="stop9" />
      <stop
         offset="100%"
         style="stop-color:#1e7e34;stop-opacity:1"
         id="stop10" />
    </linearGradient>
    <!-- Arrow markers -->
    <marker
       id="arrowhead"
       markerWidth="10"
       markerHeight="7"
       refX="9"
       refY="3.5"
       orient="auto">
      <polygon
         points="0 0, 10 3.5, 0 7"
         fill="#333"
         id="polygon10" />
    </marker>
    <marker
       id="dataArrow"
       markerWidth="10"
       markerHeight="7"
       refX="9"
       refY="3.5"
       orient="auto">
      <polygon
         points="0 0, 10 3.5, 0 7"
         fill="#0066cc"
         id="polygon11" />
    </marker>
    <linearGradient
       inkscape:collect="always"
       xlink:href="#tailscaleGradient"
       id="linearGradient62"
       x1="98.666323"
       y1="720.66382"
       x2="169.10069"
       y2="791.09819"
       gradientTransform="matrix(1.7179114,0,0,0.5821022,159.98331,19.701923)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#tailscaleGradient"
       id="linearGradient63"
       x1="180.16063"
       y1="720.66382"
       x2="250.595"
       y2="791.09819"
       gradientTransform="matrix(1.7179114,0,0,0.5821022,159.98331,19.701923)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#tailscaleGradient"
       id="linearGradient64"
       x1="261.65494"
       y1="720.66382"
       x2="332.08931"
       y2="791.09819"
       gradientTransform="matrix(1.7179114,0,0,0.5821022,159.98331,19.701923)"
       gradientUnits="userSpaceOnUse" />
    <linearGradient
       inkscape:collect="always"
       xlink:href="#tailscaleGradient"
       id="linearGradient65"
       x1="343.14925"
       y1="720.66382"
       x2="413.58362"
       y2="791.09819"
       gradientTransform="matrix(1.7179114,0,0,0.5821022,159.98331,19.701923)"
       gradientUnits="userSpaceOnUse" />
    <marker
       id="dataArrow-0"
       markerWidth="10"
       markerHeight="7"
       refX="9"
       refY="3.5"
       orient="auto">
      <polygon
         points="10,3.5 0,7 0,0 "
         fill="#0066cc"
         id="polygon11-6" />
    </marker>
  </defs>
  <!-- Background -->
  <rect
     width="1200"
     height="800"
     fill="#f8f9fa"
     id="rect11" />
  <!-- Title -->
  <text
     x="600"
     y="30"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="24px"
     font-weight="bold"
     fill="#333333"
     id="text11">F5 XC Tailnet Egress (envoy) - Architecture Diagram</text>
  <!-- F5 XC Layer -->
  <rect
     x="50"
     y="60"
     width="1100"
     height="120"
     rx="10"
     fill="url(#f5xcGradient)"
     stroke="#333"
     stroke-width="2"
     id="rect12" />
  <text
     x="600"
     y="85"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="18"
     font-weight="bold"
     fill="white"
     id="text12">
    F5 Distributed Cloud (F5 XC) Layer
  </text>
  <!-- F5 XC Components -->
  <rect
     x="100"
     y="100"
     width="150"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect13" />
  <text
     x="175"
     y="125"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text13">Origin Pools</text>
  <text
     x="175"
     y="140"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text14">Load Balancing</text>
  <rect
     x="270"
     y="100"
     width="150"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect14" />
  <text
     x="345"
     y="125"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text15">Health Checks</text>
  <text
     x="345"
     y="140"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text16">Service Monitoring</text>
  <rect
     x="440"
     y="100"
     width="150"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect16" />
  <text
     x="515"
     y="125"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text17">Traffic Distribution</text>
  <text
     x="515"
     y="140"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text18">Routing Policies</text>
  <rect
     x="610"
     y="100"
     width="150"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect18" />
  <text
     x="685"
     y="125"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text19">Security Policies</text>
  <text
     x="685"
     y="140"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text20">WAF, DDoS Protection</text>
  <rect
     x="780"
     y="100"
     width="150"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect20" />
  <text
     x="855"
     y="125"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text21">Global Load Balancer</text>
  <text
     x="855"
     y="140"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text22">Multi-Region</text>
  <rect
     x="950"
     y="100"
     width="150"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect22" />
  <text
     x="1025"
     y="125"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text23">Analytics</text>
  <text
     x="1025"
     y="140"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text24">Traffic Insights</text>
  <!-- Kubernetes Layer -->
  <rect
     x="50.088745"
     y="226.08875"
     width="1099.8225"
     height="284.53406"
     rx="9.9983864"
     fill="url(#k8sGradient)"
     stroke="#333333"
     stroke-width="2"
     id="rect24"
     style="fill:url(#k8sGradient)" />
  <text
     x="600"
     y="251"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="18px"
     font-weight="bold"
     fill="#ffffff"
     id="text25">Kubernetes Layer</text>
  <!-- K8s Components - Top Row -->
  <rect
     x="330"
     y="266"
     width="120"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect25" />
  <text
     x="390"
     y="291"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text26">Service</text>
  <text
     x="390"
     y="306"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text27">Ports: 10000+</text>
  <rect
     x="470"
     y="266"
     width="120"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect27" />
  <text
     x="530"
     y="291"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text28">RBAC</text>
  <text
     x="530"
     y="306"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text29">ServiceAccount, Role</text>
  <rect
     x="610"
     y="266"
     width="120"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect29" />
  <text
     x="670"
     y="291"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text30">ConfigMaps</text>
  <text
     x="670"
     y="306"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text31">Proxy Config</text>
  <rect
     x="750"
     y="266"
     width="120"
     height="60"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect31" />
  <text
     x="810"
     y="291"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="12px"
     font-weight="bold"
     fill="#333333"
     id="text32">Secrets</text>
  <text
     x="810"
     y="306"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     fill="#666666"
     id="text33">Tailscale Keys</text>
  <!-- StatefulSet Container - Centered -->
  <rect
     x="80.420128"
     y="342.71249"
     width="1039.1598"
     height="152.53661"
     rx="6.4947486"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="2.43092"
     id="rect37" />
  <text
     x="597.59613"
     y="365.80768"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="14px"
     font-weight="bold"
     fill="#333333"
     id="text38">StatefulSet: Proxy Containers</text>
  <!-- Envoy Container inside StatefulSet (Top) -->
  <rect
     x="502.96136"
     y="376"
     width="180"
     height="40"
     rx="3"
     fill="url(#proxyGradient)"
     stroke="#333333"
     stroke-width="1"
     id="rect38"
     style="fill:url(#proxyGradient)" />
  <text
     x="592.67816"
     y="398.52686"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     font-weight="bold"
     fill="#ffffff"
     id="text39">envoy</text>
  <text
     x="510"
     y="395"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="8px"
     fill="#ffffff"
     id="text40" />
  <!-- Flow arrows from Envoy to Tailscale containers -->
  <!-- Tailscale Containers inside StatefulSet (Bottom) -->
  <text
     x="230"
     y="542"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="8px"
     fill="#ffffff"
     id="text42">Port 10550</text>
  <text
     x="370"
     y="542"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="8px"
     fill="#ffffff"
     id="text44">Port 10551</text>
  <text
     x="510"
     y="542"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="8px"
     fill="#ffffff"
     id="text46">Port 10552</text>
  <rect
     x="329.98331"
     y="439.70193"
     width="120"
     height="40"
     rx="3"
     fill="url(#tailscaleGradient)"
     stroke="#333333"
     stroke-width="1"
     id="rect40"
     style="fill:url(#linearGradient62)" />
  <text
     x="390.15421"
     y="463.23465"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     font-weight="bold"
     fill="#ffffff"
     id="text41">tailscaled 0</text>
  <rect
     x="469.98331"
     y="439.70193"
     width="120"
     height="40"
     rx="3"
     fill="url(#tailscaleGradient)"
     stroke="#333333"
     stroke-width="1"
     id="rect42"
     style="fill:url(#linearGradient63)" />
  <text
     x="530.72064"
     y="463.23709"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     font-weight="bold"
     fill="#ffffff"
     id="text43">tailscaled 1</text>
  <rect
     x="609.98334"
     y="439.70193"
     width="120"
     height="40"
     rx="3"
     fill="url(#tailscaleGradient)"
     stroke="#333333"
     stroke-width="1"
     id="rect44"
     style="fill:url(#linearGradient64)" />
  <text
     x="670.15912"
     y="463.23709"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     font-weight="bold"
     fill="#ffffff"
     id="text45">tailscaled 2</text>
  <rect
     x="749.98334"
     y="439.70193"
     width="120"
     height="40"
     rx="3"
     fill="url(#tailscaleGradient)"
     stroke="#333333"
     stroke-width="1"
     id="rect46"
     style="fill:url(#linearGradient65)" />
  <text
     x="810.1225"
     y="463.23465"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="10px"
     font-weight="bold"
     fill="#ffffff"
     id="text47">tailscaled 3</text>
  <text
     x="650"
     y="542"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="8px"
     fill="#ffffff"
     id="text48">Port 10550+N</text>
  <!-- Flow arrows from Envoy to each Tailscale container -->
  <!-- Service Layer -->
  <!-- Service Examples -->
  <rect
     x="50.132278"
     y="559.3031"
     width="1099.913"
     height="87.124466"
     rx="9.9992085"
     fill="url(#serviceGradient)"
     stroke="#333333"
     stroke-width="2.08707"
     id="rect51"
     style="fill:url(#serviceGradient)" />
  <text
     x="600.08875"
     y="584.25958"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="18px"
     font-weight="bold"
     fill="#ffffff"
     id="text51">Tailscale Network Services</text>
  <rect
     x="170.08873"
     y="600.25958"
     width="200"
     height="30"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect52" />
  <text
     x="270.08875"
     y="620.25958"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="11px"
     font-weight="bold"
     fill="#333333"
     id="text52">app.tailnet0.ts.net:80</text>
  <rect
     x="390.08875"
     y="600.25958"
     width="200"
     height="30"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect53" />
  <text
     x="490.08875"
     y="620.25958"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="11px"
     font-weight="bold"
     fill="#333333"
     id="text53">api.tailnet1.ts.net:3000</text>
  <rect
     x="610.08875"
     y="600.25958"
     width="200"
     height="30"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect54" />
  <text
     x="710.08875"
     y="620.25958"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="11px"
     font-weight="bold"
     fill="#333333"
     id="text54">db.tailnet2.ts.net:5432</text>
  <rect
     x="830.08875"
     y="600.25958"
     width="200"
     height="30"
     rx="5"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1"
     id="rect55" />
  <text
     x="930.08875"
     y="620.25958"
     text-anchor="middle"
     font-family="Arial, sans-serif"
     font-size="11px"
     font-weight="bold"
     fill="#333333"
     id="text55">monitoring.tailnet3.ts.net:9090</text>
  <!-- Data Flow Arrows -->
  <!-- F5 XC to K8s -->
  <line
     x1="600"
     y1="182"
     x2="600"
     y2="222"
     stroke="#0066cc"
     stroke-width="3"
     marker-end="url(#dataArrow)"
     id="line56" />
  <line
     x1="600"
     y1="514.65381"
     x2="600"
     y2="554.65381"
     stroke="#0066cc"
     stroke-width="3"
     marker-end="url(#dataArrow-0)"
     id="line56-3"
     style="marker-end:url(#dataArrow-0)" />
  <!-- K8s to Proxy -->
  <!-- Proxy to Tailscale -->
  <!-- StatefulSet to Services -->
  <!-- Traffic Flow Legend -->
</svg>
